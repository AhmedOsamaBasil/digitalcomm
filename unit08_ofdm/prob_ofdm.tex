\documentclass[11pt]{article}

\usepackage{fullpage}
\usepackage{amsmath, amssymb, bm, cite, epsfig, psfrag}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{listings}
\usepackage{cite}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{enumerate}
\usepackage[outercaption]{sidecap}
\usetikzlibrary{shapes,arrows}
%\usetikzlibrary{dsp,chains}

%\restylefloat{figure}
%\theoremstyle{plain}      \newtheorem{theorem}{Theorem}
%\theoremstyle{definition} \newtheorem{definition}{Definition}

\def\del{\partial}
\def\ds{\displaystyle}
\def\ts{\textstyle}
\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqa{\begin{eqnarray}}
\def\eeqa{\end{eqnarray}}
\def\beqan{\begin{eqnarray*}}
\def\eeqan{\end{eqnarray*}}
\def\nn{\nonumber}
\def\binomial{\mathop{\mathrm{binomial}}}
\def\half{{\ts\frac{1}{2}}}
\def\Half{{\frac{1}{2}}}
\def\N{{\mathbb{N}}}
\def\Z{{\mathbb{Z}}}
\def\Q{{\mathbb{Q}}}
\def\F{{\mathbb{F}}}
\def\R{{\mathbb{R}}}
\def\C{{\mathbb{C}}}
\def\argmin{\mathop{\mathrm{arg\,min}}}
\def\argmax{\mathop{\mathrm{arg\,max}}}
%\def\span{\mathop{\mathrm{span}}}
\def\diag{\mathop{\mathrm{diag}}}
\def\x{\times}
\def\limn{\lim_{n \rightarrow \infty}}
\def\liminfn{\liminf_{n \rightarrow \infty}}
\def\limsupn{\limsup_{n \rightarrow \infty}}
\def\GV{Guo and Verd{\'u}}
\def\MID{\,|\,}
\def\MIDD{\,;\,}

\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{assumption}{Assumption}
\newtheorem{claim}{Claim}
\def\qed{\mbox{} \hfill $\Box$}
\setlength{\unitlength}{1mm}

\def\bhat{\widehat{b}}
\def\ehat{\widehat{e}}
\def\phat{\widehat{p}}
\def\qhat{\widehat{q}}
\def\rhat{\widehat{r}}
\def\shat{\widehat{s}}
\def\uhat{\widehat{u}}
\def\ubar{\overline{u}}
\def\vhat{\widehat{v}}
\def\xhat{\widehat{x}}
\def\xbar{\overline{x}}
\def\zhat{\widehat{z}}
\def\zbar{\overline{z}}
\def\la{\leftarrow}
\def\ra{\rightarrow}
\def\MSE{\mbox{\small \sffamily MSE}}
\def\SNR{\mbox{\small \sffamily SNR}}
\def\SINR{\mbox{\small \sffamily SINR}}
\def\arr{\rightarrow}
\def\Exp{\mathbb{E}}
\def\var{\mbox{var}}
\def\Tr{\mbox{Tr}}
\def\tm1{t\! - \! 1}
\def\tp1{t\! + \! 1}

\def\Xset{{\cal X}}

\newcommand{\one}{\mathbf{1}}
\newcommand{\abf}{\mathbf{a}}
\newcommand{\bbf}{\mathbf{b}}
\newcommand{\dbf}{\mathbf{d}}
\newcommand{\ebf}{\mathbf{e}}
\newcommand{\gbf}{\mathbf{g}}
\newcommand{\hbf}{\mathbf{h}}
\newcommand{\pbf}{\mathbf{p}}
\newcommand{\pbfhat}{\widehat{\mathbf{p}}}
\newcommand{\qbf}{\mathbf{q}}
\newcommand{\qbfhat}{\widehat{\mathbf{q}}}
\newcommand{\rbf}{\mathbf{r}}
\newcommand{\rbfhat}{\widehat{\mathbf{r}}}
\newcommand{\sbf}{\mathbf{s}}
\newcommand{\sbfhat}{\widehat{\mathbf{s}}}
\newcommand{\ubf}{\mathbf{u}}
\newcommand{\ubfhat}{\widehat{\mathbf{u}}}
\newcommand{\utildebf}{\tilde{\mathbf{u}}}
\newcommand{\vbf}{\mathbf{v}}
\newcommand{\vbfhat}{\widehat{\mathbf{v}}}
\newcommand{\wbf}{\mathbf{w}}
\newcommand{\wbfhat}{\widehat{\mathbf{w}}}
\newcommand{\xbf}{\mathbf{x}}
\newcommand{\xbfhat}{\widehat{\mathbf{x}}}
\newcommand{\xbfbar}{\overline{\mathbf{x}}}
\newcommand{\ybf}{\mathbf{y}}
\newcommand{\zbf}{\mathbf{z}}
\newcommand{\zbfbar}{\overline{\mathbf{z}}}
\newcommand{\zbfhat}{\widehat{\mathbf{z}}}
\newcommand{\Ahat}{\widehat{A}}
\newcommand{\Abf}{\mathbf{A}}
\newcommand{\Bbf}{\mathbf{B}}
\newcommand{\Cbf}{\mathbf{C}}
\newcommand{\Bbfhat}{\widehat{\mathbf{B}}}
\newcommand{\Dbf}{\mathbf{D}}
\newcommand{\Gbf}{\mathbf{G}}
\newcommand{\Hbf}{\mathbf{H}}
\newcommand{\Kbf}{\mathbf{K}}
\newcommand{\Pbf}{\mathbf{P}}
\newcommand{\Phat}{\widehat{P}}
\newcommand{\Qbf}{\mathbf{Q}}
\newcommand{\Rbf}{\mathbf{R}}
\newcommand{\Rhat}{\widehat{R}}
\newcommand{\Sbf}{\mathbf{S}}
\newcommand{\Ubf}{\mathbf{U}}
\newcommand{\Vbf}{\mathbf{V}}
\newcommand{\Wbf}{\mathbf{W}}
\newcommand{\Xhat}{\widehat{X}}
\newcommand{\Xbf}{\mathbf{X}}
\newcommand{\Ybf}{\mathbf{Y}}
\newcommand{\Zbf}{\mathbf{Z}}
\newcommand{\Zhat}{\widehat{Z}}
\newcommand{\Zbfhat}{\widehat{\mathbf{Z}}}
\def\alphabf{{\boldsymbol \alpha}}
\def\betabf{{\boldsymbol \beta}}
\def\mubf{{\boldsymbol \mu}}
\def\lambdabf{{\boldsymbol \lambda}}
\def\etabf{{\boldsymbol \eta}}
\def\xibf{{\boldsymbol \xi}}
\def\taubf{{\boldsymbol \tau}}
\def\sigmahat{{\widehat{\sigma}}}
\def\thetabf{{\bm{\theta}}}
\def\thetabfhat{{\widehat{\bm{\theta}}}}
\def\thetahat{{\widehat{\theta}}}
\def\mubar{\overline{\mu}}
\def\muavg{\mu}
\def\sigbf{\bm{\sigma}}
\def\etal{\emph{et al.}}
\def\Ggothic{\mathfrak{G}}
\def\Pset{{\mathcal P}}
\newcommand{\bigCond}[2]{\bigl({#1} \!\bigm\vert\! {#2} \bigr)}
\newcommand{\BigCond}[2]{\Bigl({#1} \!\Bigm\vert\! {#2} \Bigr)}

\def\Rect{\mathop{Rect}}
\def\sinc{\mathop{sinc}}
\def\Real{\mathrm{Re}}
\def\Imag{\mathrm{Im}}
\newcommand{\bkt}[1]{{\langle #1 \rangle}}



\begin{document}

\title{Problems:  OFDM Equalization}
\author{Prof.\ Sundeep Rangan}
\date{}

\maketitle

\begin{enumerate}

\item \emph{OFDM Wirless LAN}.  Use the Internet or any other source
to find the following parameters for a 40~GHz 802.11n system.
\begin{enumerate}[(a)]
\item Find the sample rate, the subcarrier spacing,
FFT size, number of samples in the CP, number of occupied subcarriers and number of pilot sub-carriers.
\item Why is the DC carrier a null carrier?
\item Suppose you use 16-QAM on all data subcarriers (sub-carriers that
are not used for pilots).  What is the data rate?
\end{enumerate}

\item \emph{OFDM Numerology}.  Find the parameters of an OFDM system
with the following properties.  The parameter should include
the sample rate, the subcarrier spacing, FFT size, number of samples in the CP,
and number of occupied subcarriers.
\begin{enumerate}[(a)]
\item The maximum delay spread is 500~ns
\item The CP overhead is approximately 25\%
\item The occupied bandwidth is approximately 40~MHz.
\item The FFT should be a power of 2.
\end{enumerate}

\item \emph{Effective SNR.}  Suppose that
\[
    y[n]=hx[n]+w[n], \quad w[n] \sim {\mathcal CN}(0,N_0), \quad |x[n]|^2 = E_x,
\]
where $h$ is a constant channel gain.  Suppose the first $N$ symbols are reference symbols,
and we estimate the channel gain $h$ via a simple average:
\[
    \widehat{h} = \frac{1}{N} \sum_{n=0}^{N-1} \frac{y[n]}{x[n]}.
\]
\begin{enumerate}[(a)]
\item Find the bias and variance of $\widehat{h}$ as a function of $N$.
\item For any subsequent symbol we can write,
\[
    y[n] = \widehat{h}x[n] + v[n], \quad v[n] = (h-\widehat{h})x[n] + w[n],
\]
where $v[n]$ is the \emph{effective noise} including channel estimation error.
Assuming $x[n]$ is independent of $w[n]$ what is the $E|v[n]|^2$, the effective noise variance.

\item What is the degradation in SNR in terms of the number of symbols $N$ you use for reference signals?
\end{enumerate}


\item \emph{MSE error with a correlation.}  Suppose that
\[
    y[n]=hx[n]+w[n], \quad w[n] \sim {\mathcal CN}(0,N_0), \quad |x[n]|^2 = 1.
\]
To estimate $h[n]$, reference signals are placed once every $N$ sub-carriers
at locations $n=0,N,2N,\ldots$.
On the reference signals, we compute the raw estimate:
$\hat{h}_0[n] = y[n]/x[n]$.
Suppose that we can model $h[n]$ as a stationary random process with $E(h[n])=0$
and $E(h[n]h^*[n-m]) = E_0 e^{-\alpha|m|}$ for some constants $E_0$ and $m$.
\begin{enumerate}[(a)]
  \item Find the MSE of the raw channel estimate $\hat{h}_0[n] = y[n]/x[n]$
  on the sub-carriers $n=0,N,2N,\cdots$.  The MSE is $\Exp|\hat{h}_0[n]-h[n]|^2$.
  \item Suppose that for other sub-carriers, we estimate $\hat{h}[n] = \hat{h}_0[kN]$ where $kN$ is the
  closest reference sub-carrier to $n$.  Find the MSE of this nearest neighbor estimate 
  $\hat{h}[n]$
  as a function of the sub-carrier index $n$.  This will be a periodic function in $n$.
  \item Suppose that the SNR $E_0/N_0$ is 20~dB and we want that the worst case
  MSE is bounded by:
  \[
        E|\hat{h}[n] - h[n]|^2 \leq 2N_0,
  \]
  for all sub-carriers $n$.  That is, we want that the estimation error to be no more than 3dB
  the MSE on the reference sub-carriers.  What is $N$ in terms of $\alpha$.  That is, how closely
  do we need to place the reference sub-carriers as a function of the rate of variation
  of the random process.
\end{enumerate}

\item \emph{Bias and Variance with a frequency rotation}.
Suppose that true OFDM channel is $h[n] = e^{in\theta}$ where $\theta$ is the
frequency rotation per sub-carrier.  We get measurements of the form,
\[
    y[n]=h[n]x[n]+w[n], \quad w[n] \sim {\mathcal CN}(0,N_0), \quad |x[n]|^2 = E_x.
\]
\begin{enumerate}[(a)]
\item Find the bias and variance of the raw channel estimate $\hat{h}_0[n] = y[n]/x[n]$.

\item Now consider a smoothed channel estimate,
\[
    \hat{h}[n] = \sum_{\ell=-L}^L \hat{h}_0[n].
\]
Find the bias and variance as a function of $L$.

\item Suppose that a channel delay $\tau = $ 0.5$\mu$s relative to the beginning of the FFT window,
and the sub-carrier spacing is $\Delta f$=15 kHz and the SNR $E_x/N_0=10$ dB.  Use MATLAB to plot
the bias squared, variance and MSE as a function of the window length $L$.
\end{enumerate}



\end{enumerate}

\end{document}

