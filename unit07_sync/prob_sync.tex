\documentclass[11pt]{article}

\usepackage{fullpage}
\usepackage{amsmath, amssymb, bm, cite, epsfig, psfrag}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{listings}
\usepackage{cite}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{enumerate}
\usepackage[outercaption]{sidecap}
\usetikzlibrary{shapes,arrows}
%\usetikzlibrary{dsp,chains}

%\restylefloat{figure}
%\theoremstyle{plain}      \newtheorem{theorem}{Theorem}
%\theoremstyle{definition} \newtheorem{definition}{Definition}

\def\del{\partial}
\def\ds{\displaystyle}
\def\ts{\textstyle}
\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqa{\begin{eqnarray}}
\def\eeqa{\end{eqnarray}}
\def\beqan{\begin{eqnarray*}}
\def\eeqan{\end{eqnarray*}}
\def\nn{\nonumber}
\def\binomial{\mathop{\mathrm{binomial}}}
\def\half{{\ts\frac{1}{2}}}
\def\Half{{\frac{1}{2}}}
\def\N{{\mathbb{N}}}
\def\Z{{\mathbb{Z}}}
\def\Q{{\mathbb{Q}}}
\def\F{{\mathbb{F}}}
\def\R{{\mathbb{R}}}
\def\C{{\mathbb{C}}}
\def\argmin{\mathop{\mathrm{arg\,min}}}
\def\argmax{\mathop{\mathrm{arg\,max}}}
%\def\span{\mathop{\mathrm{span}}}
\def\diag{\mathop{\mathrm{diag}}}
\def\x{\times}
\def\limn{\lim_{n \rightarrow \infty}}
\def\liminfn{\liminf_{n \rightarrow \infty}}
\def\limsupn{\limsup_{n \rightarrow \infty}}
\def\GV{Guo and Verd{\'u}}
\def\MID{\,|\,}
\def\MIDD{\,;\,}

\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{assumption}{Assumption}
\newtheorem{claim}{Claim}
\def\qed{\mbox{} \hfill $\Box$}
\setlength{\unitlength}{1mm}

\def\bhat{\widehat{b}}
\def\ehat{\widehat{e}}
\def\phat{\widehat{p}}
\def\qhat{\widehat{q}}
\def\rhat{\widehat{r}}
\def\shat{\widehat{s}}
\def\uhat{\widehat{u}}
\def\ubar{\overline{u}}
\def\vhat{\widehat{v}}
\def\xhat{\widehat{x}}
\def\xbar{\overline{x}}
\def\zhat{\widehat{z}}
\def\zbar{\overline{z}}
\def\la{\leftarrow}
\def\ra{\rightarrow}
\def\MSE{\mbox{\small \sffamily MSE}}
\def\SNR{\mbox{\small \sffamily SNR}}
\def\SINR{\mbox{\small \sffamily SINR}}
\def\arr{\rightarrow}
\def\Exp{\mathbb{E}}
\def\var{\mbox{var}}
\def\Tr{\mbox{Tr}}
\def\tm1{t\! - \! 1}
\def\tp1{t\! + \! 1}

\def\Xset{{\cal X}}

\newcommand{\one}{\mathbf{1}}
\newcommand{\abf}{\mathbf{a}}
\newcommand{\bbf}{\mathbf{b}}
\newcommand{\dbf}{\mathbf{d}}
\newcommand{\ebf}{\mathbf{e}}
\newcommand{\gbf}{\mathbf{g}}
\newcommand{\hbf}{\mathbf{h}}
\newcommand{\pbf}{\mathbf{p}}
\newcommand{\pbfhat}{\widehat{\mathbf{p}}}
\newcommand{\qbf}{\mathbf{q}}
\newcommand{\qbfhat}{\widehat{\mathbf{q}}}
\newcommand{\rbf}{\mathbf{r}}
\newcommand{\rbfhat}{\widehat{\mathbf{r}}}
\newcommand{\sbf}{\mathbf{s}}
\newcommand{\sbfhat}{\widehat{\mathbf{s}}}
\newcommand{\ubf}{\mathbf{u}}
\newcommand{\ubfhat}{\widehat{\mathbf{u}}}
\newcommand{\utildebf}{\tilde{\mathbf{u}}}
\newcommand{\vbf}{\mathbf{v}}
\newcommand{\vbfhat}{\widehat{\mathbf{v}}}
\newcommand{\wbf}{\mathbf{w}}
\newcommand{\wbfhat}{\widehat{\mathbf{w}}}
\newcommand{\xbf}{\mathbf{x}}
\newcommand{\xbfhat}{\widehat{\mathbf{x}}}
\newcommand{\xbfbar}{\overline{\mathbf{x}}}
\newcommand{\ybf}{\mathbf{y}}
\newcommand{\zbf}{\mathbf{z}}
\newcommand{\zbfbar}{\overline{\mathbf{z}}}
\newcommand{\zbfhat}{\widehat{\mathbf{z}}}
\newcommand{\Ahat}{\widehat{A}}
\newcommand{\Abf}{\mathbf{A}}
\newcommand{\Bbf}{\mathbf{B}}
\newcommand{\Cbf}{\mathbf{C}}
\newcommand{\Bbfhat}{\widehat{\mathbf{B}}}
\newcommand{\Dbf}{\mathbf{D}}
\newcommand{\Gbf}{\mathbf{G}}
\newcommand{\Hbf}{\mathbf{H}}
\newcommand{\Kbf}{\mathbf{K}}
\newcommand{\Pbf}{\mathbf{P}}
\newcommand{\Phat}{\widehat{P}}
\newcommand{\Qbf}{\mathbf{Q}}
\newcommand{\Rbf}{\mathbf{R}}
\newcommand{\Rhat}{\widehat{R}}
\newcommand{\Sbf}{\mathbf{S}}
\newcommand{\Ubf}{\mathbf{U}}
\newcommand{\Vbf}{\mathbf{V}}
\newcommand{\Wbf}{\mathbf{W}}
\newcommand{\Xhat}{\widehat{X}}
\newcommand{\Xbf}{\mathbf{X}}
\newcommand{\Ybf}{\mathbf{Y}}
\newcommand{\Zbf}{\mathbf{Z}}
\newcommand{\Zhat}{\widehat{Z}}
\newcommand{\Zbfhat}{\widehat{\mathbf{Z}}}
\def\alphabf{{\boldsymbol \alpha}}
\def\betabf{{\boldsymbol \beta}}
\def\mubf{{\boldsymbol \mu}}
\def\lambdabf{{\boldsymbol \lambda}}
\def\etabf{{\boldsymbol \eta}}
\def\xibf{{\boldsymbol \xi}}
\def\taubf{{\boldsymbol \tau}}
\def\sigmahat{{\widehat{\sigma}}}
\def\thetabf{{\bm{\theta}}}
\def\thetabfhat{{\widehat{\bm{\theta}}}}
\def\thetahat{{\widehat{\theta}}}
\def\mubar{\overline{\mu}}
\def\muavg{\mu}
\def\sigbf{\bm{\sigma}}
\def\etal{\emph{et al.}}
\def\Ggothic{\mathfrak{G}}
\def\Pset{{\mathcal P}}
\newcommand{\bigCond}[2]{\bigl({#1} \!\bigm\vert\! {#2} \bigr)}
\newcommand{\BigCond}[2]{\Bigl({#1} \!\Bigm\vert\! {#2} \Bigr)}

\def\Rect{\mathop{Rect}}
\def\sinc{\mathop{sinc}}
\def\Real{\mathrm{Re}}
\def\Imag{\mathrm{Im}}
\newcommand{\bkt}[1]{{\langle #1 \rangle}}



\begin{document}

\title{Problems:  Synchronization and Detection}
\author{Prof.\ Sundeep Rangan}
\date{}

\maketitle

\begin{enumerate}

\item \emph{Matched Filter SNR.}
Suppose we wish to detect a synchronization signal $x_n$, $n=0,1,\ldots,N-1$ from
received complex baseband samples of the form,
\[
    r_n = hx_n + w_n, \quad w_n \sim {\mathcal CN}(0,N_0),
    \quad n=0,1,\ldots,N-1,
\]
where $h$ is the complex channel gain and $w_n$ is AWGN noise.
\begin{enumerate}[(a)]
\item Describe the matched filter detector for the signal.
You need only describe the MF \emph{without} normalization by $\|\rbf\|^2$.
\item What is the SNR of the detector output as a function of $h$,
$x_n$ and $N_0$?
\item Suppose the signal is received at -100 dBm and the noise
power density (including the noise figure) is -170 dBm/Hz.
How long should the signal be transmitted such that the SNR of the MF
detector is 20 dB?
\item Write an expression for the probability of missed detection
as a function of the matched filter threshold and the SNR.
Your expression will be a double integral (an integral over the complex
plane).  You do not need to solve the integral.  But, you need to precisely
describe the limits of integral.
\end{enumerate}

\item \emph{Matched Filter with Carrier Offset}.
Similar to the previous problem, consider the MF detector for a
signal $x_n$.  However, suppose that there is carrier offset
so that the received samples are given by,
\[
    r_n = he^{in\theta}x_n + w_n, \quad w_n \sim {\mathcal CN}(0,N_0),
    \quad n=0,1,\ldots,N-1,
\]
where $h$ is the complex channel gain, $w_n$ is AWGN noise
and $\theta$ is the phase rotation per sample.
The phase rotation is due to carrier offset.
Assume $|x_n|$ is constant (e.g. QPSK).
\begin{enumerate}[(a)]
\item Suppose you run the MF detector assuming
there is no carrier offset (i.e.\ $\theta=0$).  What is the degradation in
SNR as a function of $\theta$ and $N$.

\item Suppose the carrier frequency is 2.5 GHz,  the oscillator error is
10 ppm.  What is the maximum duration of the transmitted signal up to which
the SNR is degrated by at most 3~dB.

\item If the carrier offset were known, how would you modify the MF
detector?
\end{enumerate}

\item \emph{Normalized MF.}  We saw in class that the normalized MF
for detecting a vector
$\xbf$ from RX samples $\rbf = h\xbf + \wbf$, computes a statistic:
\[
    \rho := \frac{|\xbf^*\rbf|^2}{\|\xbf\|^2\|\rbf\|^2}.
\]
The statistic $\rho \in [0,1]$ is the fraction of energy in the direction
of the synchronization signal $\xbf$.
Assume the signal is length $N$.
\begin{enumerate}[(a)]
\item   (This part is bonus).
Read about the Beta distribution.  Use any facts you can find
on the Internet or elsewhere to show that when
$\rbf$ is only white noise (i.e.\ there is no signal), $\rho$ is
distributed as,
\[
    \rho = 1-U^{1/N},  \quad U \sim \mathrm{Unif}(0,1).
\]

\item Suppose the MF detects the signal when $\rho > t$.
Using the result from part (a), find the threshold $t$ as a function
of $N$ and the false alarm target.

\item Write MATLAB code to run a short simulation to plot the
missed detection probability as a function of the SNR for $N=128$
and a false alarm target of $10^{-6}$.  Use any assumptions as necessary.
\end{enumerate}

\item \emph{Multiple delay hypotheses.}
In the 5G NR standard, each base station cell periodically transmits a
primary synchronization signal (PSS) that the mobile (UE) can detect.
For 5G mmWave systems, the PSS bandwidth is typically
15.24~MHz (127 subcarriers at 120~kHz subcarrier spacing).
The UE runs a matched filter (MF) to detect the PSS.
\begin{enumerate}[(a)]
\item If the MF oversampled by a factor of two, how many delay hypotheses
are there per second?

\item Suppose that to overcome carrier offset, the PSS MF detector
tries several frequency hypotheses at each delay hypotheses.
Suppose the carrier frequency is 37~GHz, the oscillator error is up to 10~ppm,
and the maximum tolerable frequency error for the detector is 200 kHz.
How many frequency hypotheses are needed in each delay hypothesis.

\item If the average number of false alarms should be less than one
false alarm per second, what should the FA target be?
Make any reasonable assumptions.
\end{enumerate}


\end{enumerate}

\end{document}

